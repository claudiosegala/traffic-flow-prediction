% TODO: Adicionar critica a todos eles quando achar. Para o urbano falar que ele utilizou o dados de diferentes tipos de vias que podem apresentar comportamentos diferentes.

\label{chapter:trabalhos_relacionados}

O objetivo deste capítulo é apresentar trabalhos relacionados à predição de tráfego urbano, mostrar suas contribuições e contextualizar o trabalho atual. A primeira seção do capítulo apresenta os trabalhos relacionados que utilizam algoritmos de aprendizagem profunda em seus modelos. A segunda seção apresenta trabalhos da área de predição de fluxo de veículos que utilizam algoritmos tradicionais.

\section{Aprendizagem Profunda}

No trabalho de Zainab Abbas et. al. \cite{Zainab_2018} é apresentado um trabalho de predição de tráfego (calculando a densidade da via em vez do fluxo) que tem como objetivo antecipar congestionamentos em rodovias de Estocolmo, Suécia, utilizando aprendizagem profunda. No caso, o autor propõe uma variação do \textit{\acrshort{LSTM}}, mais precisamente \textit{\acrfull{SLSTM}}. Para tal, são utilizados dados coletados por sensores do sistema de controle da autoestrada da cidade. Tais sensores monitoram as principais vias da metrópole e coletam informações como fluxo e velocidade de cada faixa a cada 1 minuto. O trabalho propõe três modelos de predição de densidade da via:

\begin{itemize}
    \item O (1-1) Modelo utilizando apenas um sensor que faz a predição apenas do local daquele sensor
    \item O (n-n) Modelo que utiliza n sensores de uma determinada área e faz a predição de todas as localidades
    \item O (m-n) Modelo que utiliza os m sensores mais significantes de uma área que contém um total de n sensores e que faz a predição para todos os n locais.
\end{itemize}

\begin{equation}\label{eq:solve}
k = q / v
\end{equation}
Fórmula do cálculo da densidade utilizada pelo trabalho na Equação \ref{eq:solve}, onde \textit{k} se refere a densidade, \textit{q} ao fluxo e \textit{v} à velocidade média.

Dos três modelos apresentados, o mais eficiente foi o m-n, pois faz a previsão de tráfego em vários pontos diferentes da via e tem um custo computacional menor que o n-n, pois utiliza menos sensores, o que diminui os dados de entrada da rede neural. Esse Modelo foi comparado com outros usando as métricas \textit{\acrshort{RMSE}} e \textit{\acrshort{MAE}}. O resultado dessas métricas é comparado com a acurácia de outros modelos como \textit{\acrfull{RNN}} e \textit{\acrfull{FFN}}. O erro calculado foi menor na metodologia proposta pelo autor em todos os casos, comprovando a eficácia do modelo apresentado (SLSTM).  

No artigo \cite{lv_6894591} por Yisheng Lv et. al. foi proposto um trabalho semelhante de comparação de modelos de predição, mas utilizando \textit{\acrfull{SAE}}. O modelo de predição proposto pelo artigo é aplicado aos dados coletados por 15,000 sensores espalhados pelas estradas da Califórnia. As predições são divididas em intervalos de 15, 30, 45 e 60 minutos. Mais uma vez, a acurácia dos testes foi medida utilizando  \acrshort{MAE}, \acrshort{MRE} e \acrshort{RMSE} para cada intervalo de tempo e comparada com a acurácia de predição de outros métodos, como \acrfull{BPNN}, \acrfull{RW}, \acrfull{SVM} e \acrfull{RBFNN}. Novamente, o método apresentado pelo artigo foi o mais eficiente.

Um modelo mais próximo do utilizado em nossos testes é descrito em \textit{Long Short-Term Memory Recurrent Neural Network For Urban Traffic Prediction: A Case Study of Seoul} \cite{Seoul} por Yong-Ju Lee et. al.. Diferentemente dos trabalhos relacionados apresentados nos parágrafos anteriores, esse artigo apresenta um estudo feito com dados coletados de vias urbanas de Seul, e não somente de rodovias expressas. O trabalha utiliza 3 base de dados diferentes:

\begin{itemize}
    \item Uma base gerada sintéticamente pela \textit{SK Planet Company}.
    \item Uma base coletada do governo metropolitano de Seul.
    \item Uma base de dados coletada do \textit{Aplicatio T-Map}, considerado a aplicação de navegação mais utilizada da Coreia.
\end{itemize} 

Além das 3 bases de dados, também foi adicionado ao modelo uma variável para medir o impacto das condições climáticas sobre o tráfego.
Para a predição, foram utilizados o \textit{\acrshort{LSTM}}, \textit{\acrshort{GRU}} e um método proposto chamado \textit{\acrfull{MLSTM}}. Nos testes feitos, o método de avaliação foi o \textit{\acrshort{RMSE}}, para o qual o \textit{\acrshort{MLSTM}} se mostrou mais eficiente, seguido do \textit{\acrshort{LSTM}} comum e do \textit{\acrshort{GRU}}. Porém, a diferença do RMSE entre os 3 algoritmos não ultrapassou 0.1, o que demonstra que a eficácia de todos os métodos é bem similar para o conjunto de dados do trabalho. Vale ressaltar também que todos os modelos utilizados neste trabalho se encaixam na categoria de aprendizagem profunda e derivam de redes neurais recorrentes, o que pode explicar a performance tão similar.

Em \textit{Using LSTM and GRU Neural Network Methods for Traffic Flow Prediction} \cite{fu2016using} por Rui Fu et. al. tem-se novamente o mesmo problema de predição de tráfego. Porém, segundo o autor, é apresentado pela primeira vez na literatura uma proposta de utilização de \textit{\acrfull{GRU}} para esse tipo de problema. No caso, o autor compara três modelos, sendo eles \textit{\acrshort{ARIMA}}, \textit{\acrshort{LSTM}} e \textit{\acrshort{GRU}}. Os dados utilizados pelo trabalho citado foram disponibilizados publicamente pelo governo, \textit{PeMS}, mais especificamente de \textit{Bay Area}, \textit{Alameda}, \textit{Oakland} nos Estados Unidos. 

Para o treinamento foram utilizados 50 séries temporais, cada um gerada por um sensor diferente. Já para as métricas similares aos outros artigos, \textit{\acrshort{MSE}} e \textit{\acrshort{MAE}}. No final do experimento os modelos tinham suas métricas similares, sem um diferença muito significativa. Porém com o modelo \textit{\acrshort{GRU}} sendo superior a \textit{\acrshort{LSTM}} por 84\% da série temporal e os modelos não-paramêtricos demonstrando uma melhor capacidade de se ajustar aos dados.
% TODO: adicionar critica de que ele poderia ter feito uma seleção de sensores por porximidade para tentar melhorar os resultados

\section{Algoritmos Tradicionais}

Posteriormente neste trabalho, mais especificamente no Capítulo 4, seção 4.1, serão mostrado alguns fatores que influenciam no comportamento do tráfego urbano, sendo um deles o fator aleatório. A maioria dos trabalhos na área de predição de fluxo descarta os fatores aleatórios e considera apenas cenários ideais, descartando também os períodos de manutenção, onde ocorre a total, ou parcial interrupção das vias. Porém, Yi Hou et al. em \textit{Traffic Flow Forecasting for Urban Work Zones} \cite{hou2014traffic} realizou um trabalho de predição de fluxo justamente nessas condições e, segundo o próprio autor, a falta de trabalhos da área para este tipo de cenário foi sua motivação. 

O trabalho de Yi Hou et al. apresenta um modelo de predição de fluxo em duas rodovias do \textit{Missouri}, nos Estados Unidos, mais precisamente em \textit{St.Louis}. Ambas as rodovias apresentaram um total de 161 zonas de trabalho rodoviários (ou \textit{Work Zones} como descrito pelo autor) ao longo do ano em que os dados foram coletados (Junho de 2012 até Setembro de 2013). \textit{Work Zones} são áreas de manutenção, ou construção, onde as rodovias apresentam placas de desvio, barreiras e bloqueio de algumas faixas. Outro ponto que deve ser notado é que as duas rodovias são diferentes entre si, uma delas é uma via expressa e a outra é uma via arterial sinalizada com semáforos.

Para realizar as predições, Yi Hou et al utilizou de 3 modelos de aprendizagem de máquina e uma base de comparação. Os modelos utilizados foram \acrfull{RF}, uma \acrfull{NN} e uma árvore de regressão simples. Assim como a maioria dos trabalhos da área de predição de fluxo, para calcular o erro e comparar os modelos, foram utilizadas as métricas \textit{RMSE}, \textit{MAE} e \textit{MAPE}. Suas predições consistem em quatro predições de curto prazo (15, 30, 45 e 60 minutos no futuro) e uma predição de longo prazo (24 horas no futuro). Em todos os casos, o modelo \acrshort{RF} se mostrou melhor que seus concorrentes e melhor que a base de comparação. O trabalho do autor foi inovador ao se arriscar a prever o fluxo de veículos em áreas que não continham as condições ideais, porém, é válido questionar o quão relevante é prever o fluxo de veículos no cenário apresentado pelo trabalho, visto que são situações temporárias.


Outro trabalho que também foge da abordagem tradicional é o apresentado por Xianglong Luo et. al. em \textit{Traffic Flow Prediction during the Holidays Based on DFT and SVR} \cite{luo2019traffic}. O autor se propõe a construir um modelo de predição de fluxo de veículos para feriados, analisando as flutuações e sazonalidades desses dias. O conjunto de dados utilizado no trabalho foi coletado por fiscalizadores eletrônicos encontrados em estações de pedágio espalhadas pela rodovia de \textit{Jiangsu}, uma província chinesa. Para realizar as predições, o autor propõe um modelo que combina \textit{\acrfull{DFT}} com \textit{Support Vector Regressors}, uma variação do \acrshort{SVM}. Utilizando o \acrshort{DFT}, é extraído dos dados a tendência dos mesmos e sua distribuição. Para calcular as flutuações do fluxo (que acontecem principalmente nos feriados), é utilizado o \textit{SVR}.

Depois de calculadas a tendência e as flutuações dos dados, o autor combina os resultados para gerar a predição de fluxo nos dias de feriado, mais especificamente, os feriados \textit{ Tomb-sweeping Day} e \textit{National Day}. Para validar os seus resultados, Xianglong Luo et. al utiliza outros três modelos para comparação: \acrshort{ARIMA}, \textit{SVR} sozinha e \textit{EMD-SVR}. Como métrica de comparação, é utilizado \acrshort{MAPE}, \acrshort{MAE} e \acrshort{RMSE}.  Para ambos os feriados, as predições do modelo proposto pelo autor, o \textit{DFT-SVR}, foram superiores a todas as outras. O trabalho do autor foi bem inovador ao escolher por analisar as flutuações e \textit{Outliers} dos dados, visto que a maioria dos trabalhos na literatura escolhe por analisar a tendência principal do fluxo das vias.

Yanyan Xu et. al. em \textit{Short-term Traffic Volume Prediction using Classification and Regression Trees} \cite{xu2013short} mostrou um trabalho promissor acerca de previsão de fluxo utilizando árvores de regressão. O Autor se propôs a prever o fluxo em cinco pontos distintos em uma rodovia interestadual localizada em \textit{Portland}, nos Estados Unidos.

Além do modelo de árvore de regressão proposto pelo autor, foram utilizados outros dois modelos para serem comparados. São eles: o modelo paramétrico \textit{Kalman Filter} e o modelo não paramétrico \textit{K-NN} (\textit{K Nearest Neighbours}). Para avaliação dos resultados, foram utilizadas as métricas \textit{MAPE}, que é comumente utilizada em trabalhos do gênero, e a métrica \textit{MASE} (\textit{Mean
Absolute Scaled Error}) proposta pelo autor, pois, segundo o mesmo, com esta métrica é possível comparar os resultados não apenas de modelos diferentes para um mesmo conjunto de dados, mas também de modelos diferentes com conjunto de dados diferentes. 
Quanto as previsões, o trabalho apresentou predições de fluxo de curto prazo para todas as cinco localidades (15 minutos no futuro) e em todos os testes o modelo proposto pelo autor se mostrou superior. Apesar dos resultados favoráveis aos modelos não paramétricos (em especial à arvore de regressão), talvez fosse mais interessante caso tivessem sido incluídos modelos não paramétricos considerados mais robustos e promissores na área de predição de fluxo, como \acrshort{SVM}, ou algum modelo de redes neurais recorrentes. 


Em \textit{A Short-term Traffic Flow Forecasting Method Based on the Hybrid PSO-SVR} por Wenbin Hu et. al. \cite{Hu2016} propõe uma variação do \textit{\acrfull{SVR}}. A escolha do \textit{\acrshort{SVR}} se deve ao método tendo extenso uso na literatura para problemas não lineares e predições de séries temporais. Além disso, \textit{\acrshort{SVR}} possui a capacidade de achar a melhor solução global de acordo com os estudos do autor. Nessa variação é utilizado \textit{\acrfull{PSO}} para a escolha de parâmetros do \textit{\acrshort{SVR}}. Esse trabalho se diferencia ao fazer a junção dos dois métodos, pois os modelos na literatura não costumam ser adaptativos, isto é, capaz de se adaptarem ao conjunto que estão vendo para assim prover uma solução precisa em tempo real.

% TODO: check r2
Para avaliar a performance do modelo, é utilizado \textit{\acrshort{RMSE}}, métrica de precisão do resultado obtido, e \textit{\acrfull{R2}}, métrica para quão os dados estão ajustados a regressão. Quanto menor melhor e quanto maior melhor, respectivamente. 

O artigo afirma que o modelo proposto é superior ao estado da arte, porém não fornece uma referência que embase esta afirmação.
